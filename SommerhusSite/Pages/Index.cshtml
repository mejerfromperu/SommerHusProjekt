@page
@using SommerHusProjekt.Model07
@using SommerhusSite.Services
@model IndexModel
@{
    bool userLoggedIn = SessionHelper.Get<User>(HttpContext) != null;
}

<div class="form-selectt rounded-2">
    <form method="post" class="border border-success rounded">
        <input type="submit" asp-page-handler="Search" value="Søg" class="btn btn-success" />
        Vejnavn <input type="text" asp-for="@Model.SearchStreetName" />
        Husnummer <input type="text" asp-for="@Model.SearchHouseNumber" />
        Postnummer  <input type="number" asp-for="@Model.SearchPostalCode" />
        Pris <input type="text" asp-for="@Model.SearchPrice" />
        Antal Gæster <input type="number" asp-for="@Model.SearchAmountSleepingSpace" />
        Dato Fra <input type="date" asp-for="@Model.SearchDateFrom" />
        Dato Til <input type="date" asp-for="@Model.SearchDateTo" />
    </form>
</div>


<div class="row d-flex justify-content-evenly gap-5">
    <form method="post">
    <th><input type="submit" asp-page-handler="SortAmountSleepingSpace" value="Antal Gæster" class="btn btn-success" /></th>
    <th><input type="submit" asp-page-handler="SortPrice" value="Pris" class="btn btn-success" /></th>
    <th><input type="submit" asp-page-handler="SortStreetName" value="Vejnavn" class="btn btn-success" /></th>
    </form>

    @foreach (var SommerHuse in Model.Huse)
    {
        {
                <div class="card my-2 p-2 d-flex cardSpecial">
                    <div>
                        <div class="col-12 justify-content-center">
                        @if (!string.IsNullOrEmpty(SommerHuse.Picture))
                        {
                            <img class="card-img-top cardSpecialIMG" src="data:image/jpeg;base64,@SommerHuse.Picture" />
                        }
                        else
                        {
                            <img class="card-img-top cardSpecialIMG" src="default-placeholder.png" alt="No image available" />
                        }
                        </div>

                        <div class="card-subtitle my-2">
                            <h2 id="outputLocation">@SommerHuse.City</h2>
                            <h4 id="outputPrice">@SommerHuse.StreetName</h4>
                            <h4 id="outputPrice">@SommerHuse.DateFrom</h4>
                            <h4 id="outputPrice">@SommerHuse.DateTo</h4>
                            <h4 id="outputPrice">@SommerHuse.Price</h4>
                        </div>
                        <div class="card-body text-black">
                            <h5>@SommerHuse.Description</h5>
                            <p id="outputText"></p>
                            
                            <div class="d-flex justify-content-around text-white">
                            @if (userLoggedIn)
                            {
                                <a asp-page="/BookingSite/Index" asp-route-summerhouseId="@SommerHuse.Id" class="btn btn-outline-dark rounded-pill" style="background: #DEE50F; border: 2px dimgrey; width: 50%;">Se Mere</a>
                            }
                            else
                            {
                                <div class="text text-black" role="alert">
                                    husk du skal være logget ind for at booke!
                                    <a asp-page="/UserSite/LogIn"class="btn btn-outline-dark rounded-pill" style="background: #DEE50F; border: 2px dimgrey; width: 50%;">login her</a>
                                </div>
                            }
                            @* @if(loggedinuser is not null)
                            {
                                <a asp-page="/BookingSite/Index" asp-route-summerhouseId="@SommerHuse.Id" class="btn btn-outline-dark rounded-pill" style="background: #DEE50F; border: 2px dimgrey; width: 50%;">Se Mere</a>

                            } *@

                            </div>
                        </div>
                    </div>
                </div>

        }
    }
</div>
